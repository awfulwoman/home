---
- name: zigbee2mqtt - Bootstrap users
  hosts: ha_zigbee2mqtt
  roles:
    - role: standard_users

- name: zigbee2mqtt - Bootstrap standard OS config
  hosts: ha_zigbee2mqtt
  become: true
  roles:
    - role: standard_os
    - role: raspberry_pi
    - role: weareinteractive.environment
      no_log: true

- name: zigbee2mqtt - Zigbee2MQTT
  hosts: ha_zigbee2mqtt
  roles:
    - role: geerlingguy.docker_arm
    - role: zigbee2mqtt
      vars:
        config:
          # Home Assistant integration (MQTT discovery)
          homeassistant: true

          # allow new devices to join
          permit_join: true

          # MQTT settings
          mqtt:
            # MQTT base topic for zigbee2mqtt MQTT messages
            base_topic: zigbee2mqtt
            # MQTT server URL
            server: 'mqtt://twistymotherfucker'
            # MQTT server authentication, uncomment if required:
            # user: my_user
            # password: my_password

          # Serial settings
          serial:
            # Location of CC2531 USB sniffer
            port: /dev/ttyACM0
          frontend:
            # Optional, default 8080
            port: 9091

# - name: zigbee2mqtt - Upgrade apt packages
#   hosts: ha_zigbee2mqtt
#   roles:
#     - role: upgrade
