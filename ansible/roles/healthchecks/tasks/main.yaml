- name: Pushover notification on @reboot
  become: true
  ansible.builtin.cron:
    name: "Pushover - {{ inventory_hostname }} rebooted"
    special_time: reboot
    job: sleep 30 && /usr/bin/curl -s --form-string token="{{ vault_pushover_home_automation_key }}" --form-string user="{{ vault_pushover_user_key }}" --form-string message="{{ inventory_hostname }} rebooted - $(date --iso-8601=seconds)" https://api.pushover.net/1/messages.json >> /home/ubuntu/pushover.log 2>&1
    state: absent

- name: Ping healthchecks.io on @reboot
  become: true
  ansible.builtin.cron:
    name: "healthchecks.io - system rebooted"
    special_time: reboot
    job: sleep 30 && /usr/bin/curl -fsS -m 10 --retry 5 -o /dev/null "https://hc-ping.com/{{ healthcheck_reboot_id }}" >> /home/ubuntu/healthchecks.log 2>&1
    state: absent
  when: healthcheck_reboot_id
