- name: Install NFS packages
  become: true
  ansible.builtin.apt:
    name:
      - nfs-common
    state: present

- name: Attempt to mount remote NFS backup
  block:
    - name: Mount remote NFS volumes
      become: true
      ansible.posix.mount:
        src: "{{ nfsclient_remote_server }}:{{ restic_server_path }}" # TODO: Make this a look-up from inventory data
        path: "{{ restic_client_path }}"
        state: mounted
        opts: "{{ nfsclient_mount_options }}"
        fstype: nfs
        boot: true
  rescue:
    - name: Debug remote mount failure
      ansible.builtin.debug:
        msg: "Could not mount {{ nfsclient_remote_server }}:{{ restic_server_path }}. Non-fatal. Proceeding."
