tls:
  options:
    default:
      minVersion: VersionTLS13
      sniStrict: true

http:
  middlewares:
    secHeaders:
      headers:
        browserXssFilter: true
        contentTypeNosniff: true
        frameDeny: true
        sslRedirect: true
        stsIncludeSubdomains: true
        stsPreload: true
        stsSeconds: 31536000
        customFrameOptionsValue: SAMEORIGIN
    https-redirect:
      redirectScheme:
        scheme: https

  routers:
    homeassistant:
      service: homeassistant
      rule: "Host(`homeassistant.{{ domain_name }}`)"
      tls:
        certresolver: letsencrypt
      entrypoints:
        - web
        - websecure

  services:
    homeassistant:
      networks:
        - "{{ docker_default_network }}"
      loadBalancer:
        servers:
          - url: "http://172.17.0.1:8123"
